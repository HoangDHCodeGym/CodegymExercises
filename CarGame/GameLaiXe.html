<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Game lái xe</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <style>
        #Car {
            height: 40px;
            width: 80px;
            position: absolute;
            top: 50px;
            left: 50px;
            transition: all 0.3s ease-in;
        }

        #Field {
            height: 600px;
            width: 1100px;
            position: absolute;
            top: 50px;
            left: 50px;
            border: 2px solid black;
        }

        .Bomb {
            height: 40px;
            width: 40px;
        }

        .Fruit {
            height: 40px;
            width: 40px;
        }
    </style>
</head>

<body>
    <h1>Game lái xe</h1>
    <div id="Field">
    </div>
    <img src="car.png" alt="" id="Car">
    <img src="bomb.png" class="Bomb">
    <img src="fruit.png" class="Fruit">
    <script src="colliding.js"></script>
    <script>
        let Car = function (id, maxwidth, maxheight) {
            this.score = 0;
            this.life = 3;
            this.top = 50;
            this.left = 50;
            this.id = id;
            this.orientation = "0deg";
            this.maxwidth = maxwidth;
            this.maxheight = maxheight;
            this.moveUp = function (step) {
                if (this.top > 40) {
                    this.top -= step;
                }
                this.orientation = "-90deg";
            }
            this.moveDown = function (step) {
                if (this.top < this.maxheight) {
                    this.top += step;
                }
                this.orientation = "90deg";
            }
            this.moveLeft = function (step) {
                if (this.left > 40) {
                    this.left -= step;
                }
                this.orientation = "180deg";
            }
            this.moveRight = function (step) {
                if (this.left < this.maxwidth) {
                    this.left += step;
                }
                this.orientation = "0deg";
            }
            this.hit = function () {
                this.life -= 1;
            }
            this.death = function () {
                if (this.life == 0) {
                    alert("You're death!");
                }
            }
            this.drawCar = function () {
                c = $(this.id);
                c.css("top", this.top + "px");
                c.css("left", this.left + "px");
                c.css("transform","rotate("+this.orientation+")");
            }
        }

        let FruitAndBomb = function(id,name,top,left) {
            this.exist = true;
            this.id = id;
            this.name = name;
            this.top = top;
            this.left = left;
            this.image = function() {
                if (this.name=="bomb") {
                    return "bomb.png";
                }
                if (this.name=="fruit") {
                    return "fruit.png";
                }
            }            
            this.collision = function() {
                this.exist = false;
                this.delete();
            }
            this.delete = function() {
                c = $(this.id);
                c.css("display","none");
            }
        }

        function drawFruitandBomb() {
            result = "";
            for (let i=0; i<10; i++) {
                let top = Math.floor(Math.random()*50)+50;
                let left = Math.floor(Math.random()*1000)+50;
                let fruit = new FruitAndBomb("fruit"+i,"fruit",top,left);
                result += "<img src='" + fruit.image() + "' id='fruit-"+i+"' class='Fruit' >";
                console.log(result+" "+top+" "+left);
                c = $("#fruit-"+i);
                c.css("position","absolute");
                c.css("top",top+"px");
                c.css("left",left+"px");
            }
            $("#Field").html(result);
        }
        let car = new Car("#Car", 1000, 500);
        drawFruitandBomb();
        //move car
        $(document).keydown(function (event) {
            let step = 40;
            if (event.which == 40) {
                car.moveDown(step);
                car.drawCar();
            }
            if (event.which == 38) {
                car.moveUp(step);
                car.drawCar();
            }
            if (event.which == 37) {
                car.moveLeft(step);
                car.drawCar();
            }
            if (event.which == 39) {
                car.moveRight(step);
                car.drawCar();
            }
        })
    </script>
</body>

</html>